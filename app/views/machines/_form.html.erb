<%= form_for(@machine) do |f| %>
  <% if @machine.errors.any? %>
    <%= render 'shared/errors', resource: @machine %>
  <% end %>

  <div class="row">
    <div class="col-md-6 machine-form-column">
      <div class="form-group">
        <%= f.label :stock, class: 'control-label' %>
        <%= f.text_field :stock_number, class: 'form-control',
                                        autofocus: 'autofocus',
                                        value: @machine.stock_number %>
      </div>

      <div class="form-group">
        <%= f.label :year, class: 'control-label' %>
        <%= f.select :year, [], {}, { class: 'form-control' } do %>
          <% if @machine.year != nil %>
            <%= content_tag(:option, @machine.year) %>
            <%= content_tag(:option, "--", disabled: "disabled") %>
          <% end %>
          <%= content_tag(:option, "Choose year:", disabled: "disabled") %>
          <% 41.times do |n| %>
            <%= content_tag(:option, (Time.now.year + 1) - n) %>
          <% end %>
          <%= content_tag(:option, 'Other...') %>
        <% end %>
      </div>

      <div class="form-group">
        <%= f.label :make, class: 'control-label' %>
        <%= f.text_field :make, class: 'form-control', value: @machine.make %>
      </div>

      <div class="form-group">
        <%= f.label :model, class: 'control-label' %>
        <%= f.text_field :machine_model, class: 'form-control', value: @machine.machine_model %>
      </div>

      <div class="form-group">
        <%= f.label :type, class: 'control-label' %>
        <%= f.text_field :machine_type, class: 'form-control', value: @machine.machine_type %>
      </div>
    </div>

    <div class="col-md-6 machine-form-column">
      <div class="form-group">
        <%= f.label :serial, class: 'control-label' %>
        <%= f.text_field :serial_number, class: 'form-control', value: @machine.serial_number %>
      </div>

      <div class="form-group">
        <%= f.label :hours, class: 'control-label' %>
        <%= f.text_field :hours, class: 'form-control', value: @machine.hours %>
      </div>

      <div class="form-group">
        <%= f.label :price, class: 'control-label' %>
        <div class="input-group">
          <span class="input-group-addon">$</span>
          <%= f.text_field :price, class: 'form-control',
                                   value: @machine.price,
                                   placeholder: 'No decimals or dollar signs please!' %>
        </div>
      </div>

      <div class="form-group">
        <%= f.label :dealership_id, "Location", class: 'control-label' %>
        <%= f.select :dealership_id, [], {}, { class: 'form-control' } do %>
          <% if @machine.year != nil %>
            <%= content_tag(:option, @machine.location.city) %>
            <%= content_tag(:option, "--", disabled: "disabled") %>
          <% end %>
          <%= content_tag(:option, "Choose location:", disabled: "disabled") %>
          <% current_user.dealerships.each do |dealership| %>
            <%= content_tag :option, dealership.city, value: dealership.id %>
          <% end %>
        <% end %>
      </div>

      <div class="form-group">
        <%= f.label :description, class: 'control-label' %>
        <%= f.text_area :description, class: 'form-control', rows: '4', value: @machine.description %>
      </div>
    </div>
  </div>

  <hr />

  <div class="row machine-form-buttons">
    <div class="col-md-12 text-center">
      <p>
        <%= f.submit "Save", class: "btn btn-success" %>
        or
        <%= link_to "Cancel", machines_path %>
      </p>
      <% if @machine.persisted? %>
        <%= link_to "Delete Machine", machine_path(@machine.id),
                                      method: "delete",
                                      confirm: "Are you sure you want to delete this machine?",
                                      class: "btn btn-danger" %>
      <% end %>
    </div>
  </div>
<% end %>
